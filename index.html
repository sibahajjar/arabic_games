<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arabic Letter Game</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Tone.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <style>
        /* Custom font for Arabic visibility and playful look */
        @import url('https://fonts.googleapis.com/css2?family=Changa:wght@700&display=swap');

        body {
            font-family: 'Changa', sans-serif;
            height: 100vh;
            width: 100vw;
            background-color: #f0f9ff;
            /* Light Blue Background */
            overflow: hidden;
            /* Prevent scrolling during confetti */
            user-select: none;
        }

        /* Arabic text should be very large */
        .word-display {
            font-size: 5rem;
            /* Large text on desktop */
            line-height: 1.2;
        }

        /* Emoji Display Size */
        .emoji-visual {
            font-size: 5rem;
            width: 8rem;
            height: 8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            /* Ensure images don't spill out */
        }

        /* Button size adjusted for shapes */
        .option-button {
            font-size: 3.5rem;
            min-width: 5rem;
        }

        @media (max-width: 640px) {
            .word-display {
                font-size: 3.5rem;
                /* Adjusted for mobile */
            }

            .emoji-visual {
                font-size: 4rem;
                width: 6rem;
                height: 6rem;
            }

            .option-button {
                font-size: 2.5rem;
                min-width: 4rem;
            }
        }

        /* Highlight for the missing letter position */
        .highlight-blank {
            display: inline-block;
            background-color: #ffda79;
            /* Yellow highlight */
            color: #ffda79;
            /* Match text color to background to ensure the connecting dash is visually part of the block */
            width: 1.5ch;
            /* Width based on a single character */
            text-align: center;
            border-radius: 6px;
            font-size: 0.8em;
            line-height: 1.2;
        }

        /* Selection Grid Styles */
        .letter-grid-item {
            width: 3.5rem;
            height: 3.5rem;
            font-size: 1.5rem;
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            border-width: 2px;
        }

        /* --- Confetti Animation Styles --- */
        .confetti-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 50;
        }

        .confetti {
            position: absolute;
            width: 8px;
            height: 8px;
            background-color: currentColor;
            opacity: 0;
            animation: fall 2s ease-in forwards;
        }

        @keyframes fall {
            0% {
                transform: translateY(-10vh) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
    </style>
</head>

<body class="flex items-center justify-center">

    <!-- Main Game Container -->
    <div id="game-container"
        class="relative w-full max-w-5xl p-4 flex flex-col items-center justify-center min-h-[50vh]">

        <!-- Welcome Screen (Mode Selection) -->
        <div id="welcome-screen"
            class="flex flex-col items-center justify-center text-center transition-opacity duration-500 w-full max-w-4xl">
            <p class="text-4xl sm:text-6xl text-indigo-800 mb-6 font-extrabold">Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø¨Ø¬Ø¯ÙŠØ© Ø§Ù„Ù…Ù…ØªØ¹Ø©</p>
            <p class="text-xl sm:text-2xl text-gray-500 mb-12">Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù„Ø¹Ø¨</p>

            <div class="flex flex-col sm:flex-row justify-center gap-4 w-full px-4">
                <!-- Mode 1 Button: Shapes -->
                <button onclick="showSelectionScreen('shapes')"
                    class="group relative flex flex-col items-center justify-center p-6 bg-white border-4 border-green-400 rounded-3xl shadow-xl hover:bg-green-50 hover:border-green-500 transform hover:-translate-y-2 transition-all duration-300 w-full sm:w-1/3">
                    <div class="text-5xl mb-4">ğŸ¨</div>
                    <h3 class="text-2xl font-bold text-green-700 mb-2">Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ø­Ø±ÙˆÙ</h3>
                    <p class="text-gray-500 text-sm">ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©ØŒ Ø§Ù„ÙˆØ³Ø·ØŒ Ø§Ù„Ù†Ù‡Ø§ÙŠØ©</p>
                    <div class="mt-4 bg-green-100 text-green-800 px-3 py-1 rounded-full text-xs font-bold">Ø¨Ù€ Ù€Ø¨Ù€ Ù€Ø¨
                    </div>
                </button>

                <!-- Mode 2 Button: Correct Letter -->
                <button onclick="showSelectionScreen('letters')"
                    class="group relative flex flex-col items-center justify-center p-6 bg-white border-4 border-blue-400 rounded-3xl shadow-xl hover:bg-blue-50 hover:border-blue-500 transform hover:-translate-y-2 transition-all duration-300 w-full sm:w-1/3">
                    <div class="text-5xl mb-4">ğŸ§©</div>
                    <h3 class="text-2xl font-bold text-blue-700 mb-2">Ø§Ù„Ø­Ø±Ù Ø§Ù„ØµØ­ÙŠØ­</h3>
                    <p class="text-gray-500 text-sm">Ø§Ø®ØªØ± Ø§Ù„Ø­Ø±Ù Ø§Ù„Ù†Ø§Ù‚Øµ</p>
                    <div class="mt-4 bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-xs font-bold">Ø£ Ø¨ Øª Ø«</div>
                </button>

                <!-- Mode 3 Button: Harakat -->
                <button onclick="showSelectionScreen('harakat')"
                    class="group relative flex flex-col items-center justify-center p-6 bg-white border-4 border-red-400 rounded-3xl shadow-xl hover:bg-red-50 hover:border-red-500 transform hover:-translate-y-2 transition-all duration-300 w-full sm:w-1/3">
                    <div class="text-5xl mb-4">ğŸ“¢</div>
                    <h3 class="text-2xl font-bold text-red-700 mb-2">Ø§Ù„Ø­Ø±ÙƒØ§Øª</h3>
                    <p class="text-gray-500 text-sm">Ø§Ù„ÙØªØ­Ø©ØŒ Ø§Ù„Ø¶Ù…Ø©ØŒ Ø§Ù„ÙƒØ³Ø±Ø©</p>
                    <div class="mt-4 bg-red-100 text-red-800 px-3 py-1 rounded-full text-xs font-bold">Ø¨ÙÙ€ Ø¨ÙÙ€ Ø¨ÙÙ€</div>
                </button>
            </div>
        </div>

        <!-- Selection Screen -->
        <div id="selection-screen"
            class="hidden flex flex-col items-center justify-center w-full max-w-2xl transition-opacity duration-500">
            <h2 class="text-3xl font-bold text-indigo-800 mb-2">Ø§Ø®ØªØ± Ø§Ù„Ø­Ø±ÙˆÙ</h2>
            <p id="selection-instruction" class="text-lg text-gray-600 mb-4">Ø§Ø®ØªØ± 3 Ø­Ø±ÙˆÙ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</p>

            <div id="alphabet-grid" class="flex flex-wrap justify-center gap-2 mb-8 max-w-xl">
                <!-- Grid generated by JS -->
            </div>

            <div class="flex gap-4 w-full justify-center">
                <button onclick="goHome()"
                    class="px-6 py-3 bg-gray-300 text-gray-700 text-xl font-bold rounded-full hover:bg-gray-400 transition">
                    Ø±Ø¬ÙˆØ¹
                </button>
                <button id="start-game-btn" onclick="confirmSelectionAndStart()" disabled
                    class="px-8 py-3 bg-indigo-600 text-white text-xl font-bold rounded-full shadow-lg hover:bg-indigo-700 transition disabled:opacity-50 disabled:cursor-not-allowed">
                    Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨
                </button>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen"
            class="hidden flex flex-col items-center justify-center w-full transition-opacity duration-500">

            <!-- Header: Home, Score, Lives -->
            <div class="flex justify-between items-center w-full max-w-lg mb-4">
                <div class="flex items-center gap-3">
                    <!-- Home Button -->
                    <button onclick="goHome()"
                        class="bg-white text-2xl p-2 rounded-full shadow-md hover:bg-gray-100 text-gray-700 transition-transform transform hover:scale-110 border-2 border-gray-200"
                        aria-label="Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©">
                        ğŸ 
                    </button>
                    <div id="score-display" class="text-xl text-gray-600 font-bold">Ø§Ù„Ù†Ù‚Ø§Ø·: 0</div>
                </div>
                <div id="lives-display" class="text-3xl"></div>
            </div>

            <!-- Question Card -->
            <div id="question-card"
                class="bg-white p-6 sm:p-12 w-full max-w-lg rounded-3xl shadow-2xl border-4 border-yellow-400 mb-10 transform transition-all duration-300 flex flex-col items-center">

                <!-- Visual Display (Image or Emoji) -->
                <div id="word-visual"
                    class="emoji-visual rounded-lg mb-6 shadow-md border-2 border-gray-200 bg-gray-50">
                    <!-- Content injected via JS -->
                </div>

                <p id="word-placeholder"
                    class="word-display text-center font-extrabold text-indigo-700 whitespace-nowrap">
                    <!-- Arabic Word will be displayed here -->
                </p>
                <div id="position-hint" class="text-lg text-gray-500 text-center mt-2"></div>
            </div>

            <!-- Options Grid -->
            <div id="options-grid" class="flex flex-wrap justify-center gap-4 w-full max-w-lg sm:max-w-xl">
                <!-- Buttons will be generated here -->
            </div>
        </div>

    </div>

    <!-- Fun Reward Elements -->
    <div id="confetti-holder" class="confetti-container hidden"></div>

    <script>
        // Global variables
        let currentMode = 'shapes';
        let currentWord = null;
        let wordList = [];
        let gameScore = 0;
        let gameLives = 3;
        let isProcessing = false;
        let gameTimer = null; // New variable to track timeouts

        // Selection State
        let selectedLetters = [];
        const minSelectionCount = 3;

        // Updated supported letters to include everything from Alif to Ya
        const supportedLetters = [
            'Ø£', 'Ø¨', 'Øª', 'Ø«', 'Ø¬', 'Ø­', 'Ø®',
            'Ø¯', 'Ø°', 'Ø±', 'Ø²', 'Ø³', 'Ø´', 'Øµ',
            'Ø¶', 'Ø·', 'Ø¸', 'Ø¹', 'Øº', 'Ù', 'Ù‚',
            'Ùƒ', 'Ù„', 'Ù…', 'Ù†', 'Ù‡Ù€', 'Ùˆ', 'ÙŠ'
        ];

        const arabicAlphabet = [
            'Ø£', 'Ø¨', 'Øª', 'Ø«', 'Ø¬', 'Ø­', 'Ø®',
            'Ø¯', 'Ø°', 'Ø±', 'Ø²', 'Ø³', 'Ø´', 'Øµ',
            'Ø¶', 'Ø·', 'Ø¸', 'Ø¹', 'Øº', 'Ù', 'Ù‚',
            'Ùƒ', 'Ù„', 'Ù…', 'Ù†', 'Ù‡Ù€', 'Ùˆ', 'ÙŠ'
        ];

        // --- Letter Shapes Mapping ---
        const letterShapes = {
            'Ø£': { initial: 'Ø£', medial: 'Ù€Ø£', final: 'Ù€Ø£', isolated: 'Ø£' },
            'Ø¨': { initial: 'Ø¨Ù€', medial: 'Ù€Ø¨Ù€', final: 'Ù€Ø¨', isolated: 'Ø¨' },
            'Øª': { initial: 'ØªÙ€', medial: 'Ù€ØªÙ€', final: 'Ù€Øª', isolated: 'Øª' },
            'Ø«': { initial: 'Ø«Ù€', medial: 'Ù€Ø«Ù€', final: 'Ù€Ø«', isolated: 'Ø«' },
            'Ø¬': { initial: 'Ø¬Ù€', medial: 'Ù€Ø¬Ù€', final: 'Ù€Ø¬', isolated: 'Ø¬' },
            'Ø­': { initial: 'Ø­Ù€', medial: 'Ù€Ø­Ù€', final: 'Ù€Ø­', isolated: 'Ø­' },
            'Ø®': { initial: 'Ø®Ù€', medial: 'Ù€Ø®Ù€', final: 'Ù€Ø®', isolated: 'Ø®' },
            'Ø¯': { initial: 'Ø¯', medial: 'Ù€Ø¯', final: 'Ù€Ø¯', isolated: 'Ø¯' },
            'Ø°': { initial: 'Ø°', medial: 'Ù€Ø°', final: 'Ù€Ø°', isolated: 'Ø°' },
            'Ø±': { initial: 'Ø±', medial: 'Ù€Ø±', final: 'Ù€Ø±', isolated: 'Ø±' },
            'Ø²': { initial: 'Ø²', medial: 'Ù€Ø²', final: 'Ù€Ø²', isolated: 'Ø²' },
            'Ø³': { initial: 'Ø³Ù€', medial: 'Ù€Ø³Ù€', final: 'Ù€Ø³', isolated: 'Ø³' },
            'Ø´': { initial: 'Ø´Ù€', medial: 'Ù€Ø´Ù€', final: 'Ù€Ø´', isolated: 'Ø´' },
            'Øµ': { initial: 'ØµÙ€', medial: 'Ù€ØµÙ€', final: 'Ù€Øµ', isolated: 'Øµ' },
            'Ø¶': { initial: 'Ø¶Ù€', medial: 'Ù€Ø¶Ù€', final: 'Ù€Ø¶', isolated: 'Ø¶' },
            'Ø·': { initial: 'Ø·Ù€', medial: 'Ù€Ø·Ù€', final: 'Ù€Ø·', isolated: 'Ø·' },
            'Ø¸': { initial: 'Ø¸Ù€', medial: 'Ù€Ø¸Ù€', final: 'Ù€Ø¸', isolated: 'Ø¸' },
            'Ø¹': { initial: 'Ø¹Ù€', medial: 'Ù€Ø¹Ù€', final: 'Ù€Ø¹', isolated: 'Ø¹' },
            'Øº': { initial: 'ØºÙ€', medial: 'Ù€ØºÙ€', final: 'Ù€Øº', isolated: 'Øº' },
            'Ù': { initial: 'ÙÙ€', medial: 'Ù€ÙÙ€', final: 'Ù€Ù', isolated: 'Ù' },
            'Ù‚': { initial: 'Ù‚Ù€', medial: 'Ù€Ù‚Ù€', final: 'Ù€Ù‚', isolated: 'Ù‚' },
            'Ùƒ': { initial: 'ÙƒÙ€', medial: 'Ù€ÙƒÙ€', final: 'Ù€Ùƒ', isolated: 'Ùƒ' },
            'Ù„': { initial: 'Ù„Ù€', medial: 'Ù€Ù„Ù€', final: 'Ù€Ù„', isolated: 'Ù„' },
            'Ù…': { initial: 'Ù…Ù€', medial: 'Ù€Ù…Ù€', final: 'Ù€Ù…', isolated: 'Ù…' },
            'Ù†': { initial: 'Ù†Ù€', medial: 'Ù€Ù†Ù€', final: 'Ù€Ù†', isolated: 'Ù†' },
            'Ù‡Ù€': { initial: 'Ù‡Ù€', medial: 'Ù€Ù‡Ù€', final: 'Ù€Ù‡', isolated: 'Ù‡Ù€' },
            'Ùˆ': { initial: 'Ùˆ', medial: 'Ù€Ùˆ', final: 'Ù€Ùˆ', isolated: 'Ùˆ' },
            'ÙŠ': { initial: 'ÙŠÙ€', medial: 'Ù€ÙŠÙ€', final: 'Ù€ÙŠ', isolated: 'ÙŠ' },
        };

        // --- Harakat Helpers ---
        const harakat = {
            fatha: 'Ù',
            damma: 'Ù',
            kasra: 'Ù'
        };

        // --- Helper: Remove Diacritics (Tashkeel) ---
        function removeTashkeel(text) {
            // Regex range includes common Arabic diacritics (Fatha, Damma, Kasra, Sukun, Shadda, etc.)
            return text.replace(/[\u064B-\u065F]/g, '');
        }

        // --- Tone.js Setup ---
        const synth = new Tone.Synth().toDestination();

        const correctSound = () => {
            try {
                synth.triggerAttackRelease("C5", "8n");
                setTimeout(() => synth.triggerAttackRelease("E5", "8n"), 50);
                setTimeout(() => synth.triggerAttackRelease("G5", "8n"), 100);
            } catch (e) { /* Audio context handling */ }
        };

        const incorrectSound = () => {
            try {
                const osc = new Tone.Oscillator({ frequency: "C2", type: "sawtooth", volume: -10 }).toDestination().start();
                osc.stop("+0.15");
            } catch (e) { /* Audio context handling */ }
        };

        // --- Game Data ---
        // NOTE: To add a custom image, add 'image_url' property.
        // Example: { ..., image_emoji: 'ğŸšª', image_url: 'https://example.com/door.png' }

        // --- Mode 1 (Shapes) ---
        const wordListShapes = [
            // A, B, T, Th
            { word_id: 1, correct_letter: 'Ø¨', blank_word: '_Ø§Ø¨', full_word: 'Ø¨ÙØ§Ø¨', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸšª' },
            { word_id: 2, correct_letter: 'Ø£', blank_word: '_Ø³ÙØ¯', full_word: 'Ø£ÙØ³ÙØ¯', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ¦' },
            { word_id: 3, correct_letter: 'Øª', blank_word: '_ÙØ§Ø­Ø©', full_word: 'ØªÙÙÙØ§Ø­ÙØ©', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ' },
            { word_id: 4, correct_letter: 'Ø«', blank_word: '_Ø¹Ù’Ù„ÙØ¨', full_word: 'Ø«ÙØ¹Ù’Ù„ÙØ¨', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ¦Š' },
            { word_id: 5, correct_letter: 'Øª', blank_word: 'ÙƒÙ€_Ù€Ø¨', full_word: 'ÙƒÙØªÙØ¨', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸ“š' },
            { word_id: 6, correct_letter: 'Ø¨', blank_word: 'Ø®ÙÙ€_Ù€Ø²', full_word: 'Ø®ÙØ¨Ù’Ø²', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸ' },
            { word_id: 7, correct_letter: 'Ø«', blank_word: 'Ù…ÙÙ€_Ù€Ù„Ø«', full_word: 'Ù…ÙØ«ÙÙ„Ø«', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸ”º' },
            { word_id: 8, correct_letter: 'Ø«', blank_word: 'Ù„ÙÙ€ÙŠÙ’Ù€_', full_word: 'Ù„ÙÙŠÙ’Øª', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ…' },
            { word_id: 9, correct_letter: 'Ø¨', blank_word: 'Ø£Ù_', full_word: 'Ø£ÙØ¨', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ‘¨', shape_key: 'isolated' },
            { word_id: 10, correct_letter: 'Øª', blank_word: 'Ø¨ÙÙ€ÙŠÙ’Ù€_', full_word: 'Ø¨ÙÙŠÙ’Øª', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ ' },
            { word_id: 11, correct_letter: 'Ø£', blank_word: 'ÙŠÙÙ€Ù‚Ù’Ù€Ø±Ù_', full_word: 'ÙŠÙÙ‚Ù’Ø±ÙØ£', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ“–', shape_key: 'isolated' },

            // Jeem (Ø¬)
            { word_id: 12, correct_letter: 'Ø¬', blank_word: '_Ù…ÙÙ„', full_word: 'Ø¬ÙÙ…ÙÙ„', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸª' },
            { word_id: 13, correct_letter: 'Ø¬', blank_word: 'Ø´ÙÙ€_Ù€Ø±ÙØ©', full_word: 'Ø´ÙØ¬ÙØ±ÙØ©', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸŒ³' },
            { word_id: 14, correct_letter: 'Ø¬', blank_word: 'Ø«ÙÙ„Ù’Ù€_', full_word: 'Ø«ÙÙ„Ù’Ø¬', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'â„ï¸' },

            // Haa (Ø­)
            { word_id: 15, correct_letter: 'Ø­', blank_word: '_ØµÙØ§Ù†', full_word: 'Ø­ÙØµÙØ§Ù†', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ' },
            { word_id: 16, correct_letter: 'Ø­', blank_word: 'Ø¨ÙÙ€_Ù€Ø±', full_word: 'Ø¨ÙØ­Ù’Ø±', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸŒŠ' },
            { word_id: 17, correct_letter: 'Ø­', blank_word: 'Ù…ÙÙÙ’ØªÙØ§_', full_word: 'Ù…ÙÙÙ’ØªÙØ§Ø­', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ”‘', shape_key: 'isolated' },

            // Khaa (Ø®)
            { word_id: 18, correct_letter: 'Ø®', blank_word: '_Ø±ÙÙˆÙ', full_word: 'Ø®ÙØ±ÙÙˆÙ', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ‘' },
            { word_id: 19, correct_letter: 'Ø®', blank_word: 'Ù†ÙÙ€_Ù€Ù„ÙØ©', full_word: 'Ù†ÙØ®Ù’Ù„ÙØ©', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸŒ´' },
            { word_id: 20, correct_letter: 'Ø®', blank_word: 'ØµÙØ§Ø±ÙÙˆ_', full_word: 'ØµÙØ§Ø±ÙÙˆØ®', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸš€', shape_key: 'isolated' },

            // Dal (Ø¯)
            { word_id: 21, correct_letter: 'Ø¯', blank_word: '_ÙØ¨', full_word: 'Ø¯ÙØ¨', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ»', shape_key: 'initial' },
            { word_id: 22, correct_letter: 'Ø¯', blank_word: 'ÙˆÙØ±Ù’_ÙØ©', full_word: 'ÙˆÙØ±Ù’Ø¯ÙØ©', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸŒ¹', shape_key: 'isolated' },
            { word_id: 23, correct_letter: 'Ø¯', blank_word: 'ÙŠÙÙ€_', full_word: 'ÙŠÙØ¯', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'âœ‹', shape_key: 'final' },

            // Dhal (Ø°)
            { word_id: 24, correct_letter: 'Ø°', blank_word: '_ÙØ±ÙØ©', full_word: 'Ø°ÙØ±ÙØ©', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸŒ½', shape_key: 'initial' },
            { word_id: 25, correct_letter: 'Ø°', blank_word: 'Ù†ÙØ§ÙÙÙ€_ÙØ©', full_word: 'Ù†ÙØ§ÙÙØ°ÙØ©', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸªŸ', shape_key: 'medial' },
            { word_id: 26, correct_letter: 'Ø°', blank_word: 'Ù‚ÙÙ†Ù’ÙÙÙ€_', full_word: 'Ù‚ÙÙ†Ù’ÙÙØ°', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ¦”', shape_key: 'final' },

            // Ra (Ø±)
            { word_id: 27, correct_letter: 'Ø±', blank_word: '_ÙÙŠØ´ÙØ©', full_word: 'Ø±ÙÙŠØ´ÙØ©', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸª¶', shape_key: 'initial' },
            { word_id: 28, correct_letter: 'Ø±', blank_word: 'ÙƒÙÙ€_Ù’Ø³ÙÙŠ', full_word: 'ÙƒÙØ±Ù’Ø³ÙÙŠ', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸª‘', shape_key: 'medial' },
            { word_id: 29, correct_letter: 'Ø±', blank_word: 'Ù‚ÙÙ…ÙÙ€_', full_word: 'Ù‚ÙÙ…ÙØ±', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸŒ™', shape_key: 'final' },

            // Zay (Ø²)
            { word_id: 30, correct_letter: 'Ø²', blank_word: '_ÙÙ‡Ù’Ø±ÙØ©', full_word: 'Ø²ÙÙ‡Ù’Ø±ÙØ©', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸŒ¼', shape_key: 'initial' },
            { word_id: 31, correct_letter: 'Ø²', blank_word: 'Ù…ÙÙ†Ù’Ù€_ÙÙ„', full_word: 'Ù…ÙÙ†Ù’Ø²ÙÙ„', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸ ', shape_key: 'medial' },
            { word_id: 32, correct_letter: 'Ø²', blank_word: 'Ù…ÙÙˆÙ’_', full_word: 'Ù…ÙÙˆÙ’Ø²', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸŒ', shape_key: 'isolated' },

            // Ain (Ø¹)
            { word_id: 33, correct_letter: 'Ø¹', blank_word: '_ÙÙŠÙ’Ù†', full_word: 'Ø¹ÙÙŠÙ’Ù†', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ‘ï¸' },
            { word_id: 34, correct_letter: 'Ø¹', blank_word: 'ÙƒÙÙ€_Ù’Ù€ÙƒÙØ©', full_word: 'ÙƒÙØ¹Ù’ÙƒÙØ©', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸ‚' },
            { word_id: 35, correct_letter: 'Ø¹', blank_word: 'Ø¥ÙØµÙ’Ø¨ÙÙ€_', full_word: 'Ø¥ÙØµÙ’Ø¨ÙØ¹', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'â˜ï¸' },

            // Ghain (Øº)
            { word_id: 36, correct_letter: 'Øº', blank_word: '_ÙÙŠÙ’Ù…ÙØ©', full_word: 'ØºÙÙŠÙ’Ù…ÙØ©', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'â˜ï¸' },
            { word_id: 37, correct_letter: 'Øº', blank_word: 'Ø¨ÙØ¨Ù’Ù€_ÙÙ€Ø§Ø¡', full_word: 'Ø¨ÙØ¨Ù’ØºÙØ§Ø¡', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸ¦œ' },
            { word_id: 38, correct_letter: 'Øº', blank_word: 'ØµÙÙ…Ù’Ù€_', full_word: 'ØµÙÙ…Ù’Øº', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ§´' },

            // --- NEW LETTERS (Seen to Ya) ---
            // Seen (Ø³)
            { word_id: 40, correct_letter: 'Ø³', blank_word: '_Ù…ÙÙƒÙØ©', full_word: 'Ø³ÙÙ…ÙÙƒÙØ©', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸŸ' },
            { word_id: 41, correct_letter: 'Ø³', blank_word: 'Ø¹Ù€_Ù€Ù„', full_word: 'Ø¹ÙØ³ÙÙ„', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸ¯' },
            { word_id: 42, correct_letter: 'Ø³', blank_word: 'Ø´ÙÙ…Ù’Ù€_', full_word: 'Ø´ÙÙ…Ù’Ø³', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'â˜€ï¸' },

            // Sheen (Ø´)
            { word_id: 43, correct_letter: 'Ø´', blank_word: '_Ù…Ù’Ø¹ÙØ©', full_word: 'Ø´ÙÙ…Ù’Ø¹ÙØ©', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ•¯ï¸' },
            { word_id: 44, correct_letter: 'Ø´', blank_word: 'ÙØ±Ø§_Ù€Ø©', full_word: 'ÙÙØ±ÙØ§Ø´ÙØ©', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸ¦‹' },
            { word_id: 45, correct_letter: 'Ø´', blank_word: 'Ø¹Ù€_', full_word: 'Ø¹ÙØ´', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸª¹' },

            // Sad (Øµ)
            { word_id: 46, correct_letter: 'Øµ', blank_word: '_Ù‚Ù’Ø±', full_word: 'ØµÙÙ‚Ù’Ø±', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ¦…' },
            { word_id: 47, correct_letter: 'Øµ', blank_word: 'Ø¨Ù€_Ù€Ù„Ø©', full_word: 'Ø¨ÙØµÙÙ„ÙØ©', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸ§…' },
            { word_id: 48, correct_letter: 'Øµ', blank_word: 'Ù…ÙÙ‚ÙÙ€_', full_word: 'Ù…ÙÙ‚ÙØµ', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'âœ‚ï¸' },

            // Dhad (Ø¶)
            { word_id: 49, correct_letter: 'Ø¶', blank_word: '_ÙÙ’Ø¯ÙØ¹', full_word: 'Ø¶ÙÙÙ’Ø¯ÙØ¹', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ¸' },
            { word_id: 50, correct_letter: 'Ø¶', blank_word: 'Ø®Ù€_Ù€Ø§Ø±', full_word: 'Ø®ÙØ¶ÙØ§Ø±', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_url: 'https://i.pinimg.com/736x/c2/8c/51/c28c51c74efeb16be574f3159b22d2c3.jpg' },
            { word_id: 51, correct_letter: 'Ø¶', blank_word: 'Ø¨ÙÙŠÙ’Ù€_', full_word: 'Ø¨ÙÙŠÙ’Ø¶', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ¥š' },

            // Ta (Ø·)
            { word_id: 52, correct_letter: 'Ø·', blank_word: '_Ø§Ø¦Ø±Ø©', full_word: 'Ø·ÙØ§Ø¦ÙØ±ÙØ©', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'âœˆï¸' },
            { word_id: 53, correct_letter: 'Ø·', blank_word: 'Ù‚Ù€_Ù€Ø§Ø±', full_word: 'Ù‚ÙØ·ÙØ§Ø±', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸš‚' },
            { word_id: 54, correct_letter: 'Ø·', blank_word: 'Ø®ÙÙŠÙ’Ù€_', full_word: 'Ø®ÙÙŠÙ’Ø·', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ§µ' },

            // Zha (Ø¸)
            { word_id: 55, correct_letter: 'Ø¸', blank_word: '_ÙØ±Ù’Ù', full_word: 'Ø¸ÙØ±Ù’Ù', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'âœ‰ï¸' },
            { word_id: 56, correct_letter: 'Ø¸', blank_word: 'Ù…Ù€_Ù€Ù„Ø©', full_word: 'Ù…ÙØ¸ÙÙ„Ù‘ÙØ©', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'â˜‚ï¸' },
            { word_id: 57, correct_letter: 'Ø¸', blank_word: 'Ø¥ÙØ³Ù’ØªÙÙŠÙ’Ù‚ÙÙ€_', full_word: 'Ø¥ÙØ³Ù’ØªÙÙŠÙ’Ù‚ÙØ¸Ù', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_url: 'https://img.freepik.com/premium-vector/cartoon-boy-is-waking-up-bed-is-stretching-vector-illustration_851674-46307.jpg' },

            // Fa (Ù)
            { word_id: 58, correct_letter: 'Ù', blank_word: '_ÙÙŠÙ„', full_word: 'ÙÙÙŠÙ„', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ˜' },
            { word_id: 59, correct_letter: 'Ù', blank_word: 'Ù‚Ù€_Ù€Ù„', full_word: 'Ù‚ÙÙÙ’Ù„', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸ”’' },
            { word_id: 60, correct_letter: 'Ù', blank_word: 'Ø£ÙÙ†Ù’Ù€_', full_word: 'Ø£ÙÙ†Ù’Ù', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ‘ƒ' },

            // Qaf (Ù‚)
            { word_id: 61, correct_letter: 'Ù‚', blank_word: '_ÙÙ„ÙÙ…', full_word: 'Ù‚ÙÙ„ÙÙ…', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ–Šï¸' },
            { word_id: 62, correct_letter: 'Ù‚', blank_word: 'Ù…ÙÙ„Ù’Ø¹ÙÙ€_ÙÙ€Ø©', full_word: 'Ù…ÙÙ„Ù’Ø¹ÙÙ‚ÙØ©', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸ¥„' },
            { word_id: 63, correct_letter: 'Ù‚', blank_word: 'Ø¨ÙØ±Ù’_', full_word: 'Ø¨ÙØ±Ù’Ù‚', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸŒ©ï¸' },

            // Kaf (Ùƒ)
            { word_id: 64, correct_letter: 'Ùƒ', blank_word: '_ÙÙ„Ù’Ø¨', full_word: 'ÙƒÙÙ„Ù’Ø¨', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ•' },
            { word_id: 65, correct_letter: 'Ùƒ', blank_word: 'Ø¹ÙÙ†Ù’Ù€_ÙÙ€Ø¨ÙÙˆØª', full_word: 'Ø¹ÙÙ†Ù’ÙƒÙØ¨ÙÙˆØª', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸ•·ï¸' },
            { word_id: 66, correct_letter: 'Ùƒ', blank_word: 'Ø¯ÙÙŠÙ€_', full_word: 'Ø¯ÙÙŠÙƒ', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ“' },

            // Lam (Ù„)
            { word_id: 67, correct_letter: 'Ù„', blank_word: '_ÙÙŠÙ’Ù…ÙÙˆÙ†', full_word: 'Ù„ÙÙŠÙ’Ù…ÙÙˆÙ†', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ‹' },
            { word_id: 68, correct_letter: 'Ù„', blank_word: 'Ø³ÙÙ€_Ù‘ÙÙ€Ù…', full_word: 'Ø³ÙÙ„Ù‘ÙÙ…', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸªœ' },
            { word_id: 69, correct_letter: 'Ù„', blank_word: 'Ø¬ÙÙ…ÙÙ€_', full_word: 'Ø¬ÙÙ…ÙÙ„', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸª' },

            // Meem (Ù…)
            { word_id: 70, correct_letter: 'Ù…', blank_word: '_ÙÙÙ’ØªÙØ§Ø­', full_word: 'Ù…ÙÙÙ’ØªÙØ§Ø­', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ—ï¸' },
            { word_id: 71, correct_letter: 'Ù…', blank_word: 'Ù†Ù€_Ù€Ù„Ø©', full_word: 'Ù†ÙÙ…Ù’Ù„ÙØ©', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸœ' },
            { word_id: 72, correct_letter: 'Ù…', blank_word: 'Ù„ÙØ­Ù’Ù€_', full_word: 'Ù„ÙØ­Ù’Ù…', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ¥©' },

            // Noon (Ù†)
            { word_id: 73, correct_letter: 'Ù†', blank_word: '_ÙÙ…ÙØ±', full_word: 'Ù†ÙÙ…ÙØ±', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ…' },
            { word_id: 74, correct_letter: 'Ù†', blank_word: 'Ø¹ÙÙ€_ÙÙ€Ø¨', full_word: 'Ø¹ÙÙ†ÙØ¨', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸ‡' },
            { word_id: 75, correct_letter: 'Ù†', blank_word: 'Ø¬ÙØ¨Ù’Ù€_', full_word: 'Ø¬ÙØ¨Ù’Ù†', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ§€' },

            // Ha (Ù‡Ù€)
            { word_id: 76, correct_letter: 'Ù‡Ù€', blank_word: '_ÙØ¯ÙÙŠÙØ©', full_word: 'Ù‡ÙØ¯ÙÙŠÙØ©', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ' },
            { word_id: 77, correct_letter: 'Ù‡Ù€', blank_word: 'Ù†Ù€_Ù€Ø±', full_word: 'Ù†ÙÙ‡Ù’Ø±', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_url: 'https://static.vecteezy.com/system/resources/thumbnails/054/064/194/small/illustration-of-serene-flowing-river-in-lush-green-forest-landscape-scene-free-vector.jpg' },
            { word_id: 78, correct_letter: 'Ù‡Ù€', blank_word: 'ÙˆÙØ¬Ù’Ù€_', full_word: 'ÙˆÙØ¬Ù’Ù‡', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ˜' },

            // Waw (Ùˆ)
            { word_id: 79, correct_letter: 'Ùˆ', blank_word: '_ÙØ±Ù’Ø¯ÙØ©', full_word: 'ÙˆÙØ±Ù’Ø¯ÙØ©', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸŒ¹' },
            { word_id: 80, correct_letter: 'Ùˆ', blank_word: 'Ø®Ù€_Ù€Ø®', full_word: 'Ø®ÙÙˆÙ’Ø®', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸ‘', shape_key: 'medial' },
            { word_id: 81, correct_letter: 'Ùˆ', blank_word: 'Ø¯ÙÙ„Ù’Ù€_', full_word: 'Ø¯ÙÙ„Ù’Ùˆ', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸª£' },

            // Ya (ÙŠ)
            { word_id: 82, correct_letter: 'ÙŠ', blank_word: '_ÙØ¯', full_word: 'ÙŠÙØ¯', position: 'Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©', image_emoji: 'âœ‹' },
            { word_id: 83, correct_letter: 'ÙŠ', blank_word: 'Ø¨Ù€_Ù€Øª', full_word: 'Ø¨ÙÙŠÙ’Øª', position: 'Ø§Ù„Ù€ÙˆØ³Ù€Ø·', image_emoji: 'ğŸ ' },
            { word_id: 84, correct_letter: 'ÙŠ', blank_word: 'Ø´ÙØ±Ù’Ø·ÙÙ€_', full_word: 'Ø´ÙØ±Ù’Ø·ÙÙŠ', position: 'Ø§Ù„Ù€Ù†Ù€Ù‡Ù€Ø§ÙŠÙ€Ø©', image_emoji: 'ğŸ‘®' },
        ];

        // --- Game Data: Mode 2 (Letters) ---
        const wordListLetters = [
            // Initial
            { word_id: 101, correct_letter: 'Ø£', blank_word: '_Ø±Ù†Ø¨', full_word: 'Ø£ÙØ±Ù†Ø¨', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ°', distractors: ['Ø¨', 'Øª', 'Ø«'] },
            { word_id: 103, correct_letter: 'Ø¨', blank_word: '_Ø·Ø©', full_word: 'Ø¨ÙØ·Ø©', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ¦†', distractors: ['Ø£', 'Øª', 'Ø«'] },
            { word_id: 105, correct_letter: 'Øª', blank_word: '_Ø§Ø¬', full_word: 'ØªÙØ§Ø¬', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ‘‘', distractors: ['Ø¨', 'Ø«', 'Ø£'] },
            { word_id: 107, correct_letter: 'Ø«', blank_word: '_ÙˆØ±', full_word: 'Ø«ÙÙˆØ±', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ‚', distractors: ['Ø¨', 'Øª', 'Ø£'] },

            // Medial
            { word_id: 109, correct_letter: 'Ø£', blank_word: 'ÙÙÙ€_Ù€Ø±', full_word: 'ÙÙØ£Ø±', position: 'ÙˆØ³Ø· Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ­', distractors: ['Ø¨', 'Øª', 'Ø«'] },
            { word_id: 110, correct_letter: 'Ø¨', blank_word: 'Ø­ÙÙ€_Ù€Ù„', full_word: 'Ø­ÙØ¨Ù’Ù„', position: 'ÙˆØ³Ø· Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ§¶', distractors: ['Ø£', 'Øª', 'Ø«'] },
            { word_id: 111, correct_letter: 'Øª', blank_word: 'ÙƒÙÙ€_Ù€Ø§Ø¨', full_word: 'ÙƒÙØªÙØ§Ø¨', position: 'ÙˆØ³Ø· Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ“–', distractors: ['Ø£', 'Ø¨', 'Ø«'] },

            // Final
            { word_id: 114, correct_letter: 'Ø¨', blank_word: 'Ø¹ÙÙ†ÙÙ€_', full_word: 'Ø¹ÙÙ†ÙØ¨', position: 'Ø¢Ø®Ø± Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ‡', distractors: ['Ø£', 'Øª', 'Ø«'] },
            { word_id: 115, correct_letter: 'Øª', blank_word: 'Ø¨ÙÙŠÙ’Ù€_', full_word: 'Ø¨ÙÙŠÙ’Øª', position: 'Ø¢Ø®Ø± Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ ', distractors: ['Ø£', 'Ø¨', 'Ø«'] },
            { word_id: 116, correct_letter: 'Ø«', blank_word: 'Ù…ÙØ«ÙÙ„Ù€_', full_word: 'Ù…ÙØ«ÙÙ„ÙØ«', position: 'Ø¢Ø®Ø± Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ”º', distractors: ['Ø£', 'Ø¨', 'Øª'] },

            // Jeem
            { word_id: 120, correct_letter: 'Ø¬', blank_word: '_Ø²ÙØ±', full_word: 'Ø¬ÙØ²ÙØ±', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ¥•', distractors: ['Ø­', 'Ø®', 'Ø£'] },
            { word_id: 121, correct_letter: 'Ø¬', blank_word: 'Ø¯Ù_Ø§Ø¬Ø©', full_word: 'Ø¯ÙØ¬ÙØ§Ø¬ÙØ©', position: 'ÙˆØ³Ø· Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ”', distractors: ['Ø­', 'Ø®', 'Ø¨'] },
            { word_id: 122, correct_letter: 'Ø¬', blank_word: 'Ø¨ÙØ±Ù’_', full_word: 'Ø¨ÙØ±Ù’Ø¬', position: 'Ø¢Ø®Ø± Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ—¼', distractors: ['Ø­', 'Ø®', 'Øª'] },

            // Haa
            { word_id: 123, correct_letter: 'Ø­', blank_word: '_ÙˆØª', full_word: 'Ø­ÙÙˆØª', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ‹', distractors: ['Ø¬', 'Ø®', 'Ø£'] },
            { word_id: 124, correct_letter: 'Ø­', blank_word: 'Ù†ÙÙ€_Ù€Ù„ÙØ©', full_word: 'Ù†ÙØ­Ù’Ù„ÙØ©', position: 'ÙˆØ³Ø· Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ', distractors: ['Ø¬', 'Ø®', 'Ø¨'] },
            { word_id: 125, correct_letter: 'Ø­', blank_word: 'ØªÙÙÙØ§_', full_word: 'ØªÙÙÙØ§Ø­', position: 'Ø¢Ø®Ø± Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ', distractors: ['Ø¬', 'Ø®', 'Øª'] },

            // Khaa
            { word_id: 126, correct_letter: 'Ø®', blank_word: '_Ø§ØªÙÙ…', full_word: 'Ø®ÙØ§ØªÙÙ…', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ’', distractors: ['Ø¬', 'Ø­', 'Ø£'] },
            { word_id: 127, correct_letter: 'Ø®', blank_word: 'ØµÙÙ€_Ù€Ø±ÙØ©', full_word: 'ØµÙØ®Ù’Ø±ÙØ©', position: 'ÙˆØ³Ø· Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸª¨', distractors: ['Ø¬', 'Ø­', 'Ø¨'] },
            { word_id: 128, correct_letter: 'Ø®', blank_word: 'Ø®ÙÙˆÙ’_', full_word: 'Ø®ÙÙˆÙ’Ø®', position: 'Ø¢Ø®Ø± Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ‘', distractors: ['Ø¬', 'Ø­', 'Øª'] },

            // Dal
            { word_id: 129, correct_letter: 'Ø¯', blank_word: '_ÙØ±ÙØ§Ø¬ÙØ©', full_word: 'Ø¯ÙØ±ÙØ§Ø¬ÙØ©', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸš²', distractors: ['Ø°', 'Ø±', 'Ø²'] },
            { word_id: 130, correct_letter: 'Ø¯', blank_word: 'Ù‡ÙÙ€_ÙÙŠÙØ©', full_word: 'Ù‡ÙØ¯ÙÙŠÙØ©', position: 'ÙˆØ³Ø· Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ', distractors: ['Ø°', 'Ø±', 'Ø²'] },
            { word_id: 131, correct_letter: 'Ø¯', blank_word: 'Ù‚ÙØ±Ù’_', full_word: 'Ù‚ÙØ±Ù’Ø¯', position: 'Ø¢Ø®Ø± Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ’', distractors: ['Ø°', 'Ø±', 'Ø²'] },

            // Dhal
            { word_id: 132, correct_letter: 'Ø°', blank_word: '_ÙÙŠÙ’Ù„', full_word: 'Ø°ÙÙŠÙ’Ù„', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ•', distractors: ['Ø¯', 'Ø±', 'Ø²'] },
            { word_id: 133, correct_letter: 'Ø°', blank_word: 'Ø­ÙÙ€_ÙØ§Ø¡', full_word: 'Ø­ÙØ°ÙØ§Ø¡', position: 'ÙˆØ³Ø· Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ‘', distractors: ['Ø¯', 'Ø±', 'Ø²'] },
            { word_id: 134, correct_letter: 'Ø°', blank_word: 'ØªÙÙ„Ù’Ù…ÙÙŠÙ€_', full_word: 'ØªÙÙ„Ù’Ù…ÙÙŠØ°', position: 'Ø¢Ø®Ø± Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ§‘â€ğŸ“', distractors: ['Ø¯', 'Ø±', 'Ø²'] },

            // Ra
            { word_id: 135, correct_letter: 'Ø±', blank_word: '_ÙØ¬ÙÙ„', full_word: 'Ø±ÙØ¬ÙÙ„', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ‘¨', distractors: ['Ø²', 'Ø¯', 'Ø°'] },
            { word_id: 136, correct_letter: 'Ø±', blank_word: 'ÙÙÙ€_ÙØ§Ø´ÙØ©', full_word: 'ÙÙØ±ÙØ§Ø´ÙØ©', position: 'ÙˆØ³Ø· Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ¦‹', distractors: ['Ø²', 'Ø¯', 'Ø°'] },
            { word_id: 137, correct_letter: 'Ø±', blank_word: 'Ù‚ÙØ·ÙØ§_', full_word: 'Ù‚ÙØ·ÙØ§Ø±', position: 'Ø¢Ø®Ø± Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸš‚', distractors: ['Ø²', 'Ø¯', 'Ø°'] },

            // Zay
            { word_id: 138, correct_letter: 'Ø²', blank_word: '_ÙÙŠÙ’ØªÙÙˆÙ†', full_word: 'Ø²ÙÙŠÙ’ØªÙÙˆÙ†', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ«’', distractors: ['Ø±', 'Ø¯', 'Ø°'] },
            { word_id: 139, correct_letter: 'Ø²', blank_word: 'ØºÙÙ€_ÙØ§Ù„', full_word: 'ØºÙØ²ÙØ§Ù„', position: 'ÙˆØ³Ø· Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ¦Œ', distractors: ['Ø±', 'Ø¯', 'Ø°'] },
            { word_id: 140, correct_letter: 'Ø²', blank_word: 'Ø®ÙØ¨Ù’Ù€_', full_word: 'Ø®ÙØ¨Ù’Ø²', position: 'Ø¢Ø®Ø± Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ', distractors: ['Ø±', 'Ø¯', 'Ø°'] },

            // Ain
            { word_id: 141, correct_letter: 'Ø¹', blank_word: '_ÙÙ†Ù’ÙƒÙØ¨ÙÙˆØª', full_word: 'Ø¹ÙÙ†Ù’ÙƒÙØ¨ÙÙˆØª', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ•·ï¸', distractors: ['Øº', 'Ø­', 'Ø®'] },
            { word_id: 142, correct_letter: 'Ø¹', blank_word: 'Ù…ÙÙ€_Ù„ÙÙ…', full_word: 'Ù…ÙØ¹ÙÙ„ÙÙ…', position: 'ÙˆØ³Ø· Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ‘¨â€ğŸ«', distractors: ['Øº', 'Ø­', 'Ø®'] },
            { word_id: 143, correct_letter: 'Ø¹', blank_word: 'Ø¶ÙÙÙ’Ø¯Ù_', full_word: 'Ø¶ÙÙÙ’Ø¯ÙØ¹', position: 'Ø¢Ø®Ø± Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ¸', distractors: ['Øº', 'Ø­', 'Ø®'] },

            // Ghain
            { word_id: 144, correct_letter: 'Øº', blank_word: '_ÙÙˆÙØ§Øµ', full_word: 'ØºÙÙˆÙØ§Øµ', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ¤¿', distractors: ['Ø¹', 'Ø­', 'Ø®'] },
            { word_id: 145, correct_letter: 'Øº', blank_word: 'Ù…ÙÙ€_Ù†ÙØ§Ø·ÙÙŠØ³', full_word: 'Ù…ÙØºÙ’Ù†ÙØ§Ø·ÙÙŠØ³', position: 'ÙˆØ³Ø· Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ§²', distractors: ['Ø¹', 'Ø­', 'Ø®'] },
            { word_id: 146, correct_letter: 'Øº', blank_word: 'Ø¯ÙÙ…ÙØ§_', full_word: 'Ø¯ÙÙ…ÙØ§Øº', position: 'Ø¢Ø®Ø± Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ§ ', distractors: ['Ø¹', 'Ø­', 'Ø®'] },

            // --- NEW LETTERS (Letters Mode) ---
            // Reuse common words, added for completeness
            { word_id: 150, correct_letter: 'Ø³', blank_word: '_Ù…ÙÙƒÙØ©', full_word: 'Ø³ÙÙ…ÙÙƒÙØ©', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸŸ', distractors: ['Ø´', 'Øµ', 'Ø²'] },
            { word_id: 151, correct_letter: 'Ø³', blank_word: 'Ø¹Ù€_Ù€Ù„', full_word: 'Ø¹ÙØ³ÙÙ„', position: 'ÙˆØ³Ø· Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ¯', distractors: ['Ø´', 'Øµ', 'Ø³'] },
            { word_id: 152, correct_letter: 'Ø´', blank_word: '_Ù…Ù’Ø¹ÙØ©', full_word: 'Ø´ÙÙ…Ù’Ø¹ÙØ©', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ•¯ï¸', distractors: ['Ø³', 'Øµ', 'Ø¶'] },
            { word_id: 153, correct_letter: 'Øµ', blank_word: '_Ù‚Ù’Ø±', full_word: 'ØµÙÙ‚Ù’Ø±', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ¦…', distractors: ['Ø¶', 'Ø³', 'Øµ'] },
            { word_id: 154, correct_letter: 'Ø¶', blank_word: '_ÙÙ’Ø¯ÙØ¹', full_word: 'Ø¶ÙÙÙ’Ø¯ÙØ¹', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ¸', distractors: ['Øµ', 'Ø·', 'Ø¸'] },
            { word_id: 155, correct_letter: 'Ø·', blank_word: '_Ø§Ø¦Ø±Ø©', full_word: 'Ø·ÙØ§Ø¦ÙØ±ÙØ©', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'âœˆï¸', distractors: ['Ø¸', 'Øµ', 'Ø¶'] },
            { word_id: 156, correct_letter: 'Ø¸', blank_word: '_ÙØ±Ù’Ù', full_word: 'Ø¸ÙØ±Ù’Ù', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'âœ‰ï¸', distractors: ['Ø·', 'Ø¶', 'Ø²'] },
            { word_id: 157, correct_letter: 'Ù', blank_word: '_ÙÙŠÙ„', full_word: 'ÙÙÙŠÙ„', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ˜', distractors: ['Ù‚', 'Ùƒ', 'Ù…'] },
            { word_id: 158, correct_letter: 'Ù‚', blank_word: '_ÙÙ„ÙÙ…', full_word: 'Ù‚ÙÙ„ÙÙ…', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ–Šï¸', distractors: ['Ù', 'Ùƒ', 'Ù„'] },
            { word_id: 159, correct_letter: 'Ùƒ', blank_word: '_ÙÙ„Ù’Ø¨', full_word: 'ÙƒÙÙ„Ù’Ø¨', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ•', distractors: ['Ù‚', 'Ù„', 'Ù…'] },
            { word_id: 160, correct_letter: 'Ù„', blank_word: '_ÙÙŠÙ’Ù…ÙÙˆÙ†', full_word: 'Ù„ÙÙŠÙ’Ù…ÙÙˆÙ†', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ‹', distractors: ['Ùƒ', 'Ù…', 'Ù†'] },
            { word_id: 161, correct_letter: 'Ù…', blank_word: '_ÙÙÙ’ØªÙØ§Ø­', full_word: 'Ù…ÙÙÙ’ØªÙØ§Ø­', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ—ï¸', distractors: ['Ù„', 'Ù†', 'Ù‡Ù€'] },
            { word_id: 162, correct_letter: 'Ù†', blank_word: '_ÙÙ…ÙØ±', full_word: 'Ù†ÙÙ…ÙØ±', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ…', distractors: ['Ø¨', 'Øª', 'Ù…'] },
            { word_id: 163, correct_letter: 'Ù‡Ù€', blank_word: '_ÙØ¯ÙÙŠÙØ©', full_word: 'Ù‡ÙØ¯ÙÙŠÙØ©', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸ', distractors: ['Ø©', 'Ø¹', 'Ø­'] },
            { word_id: 164, correct_letter: 'Ùˆ', blank_word: '_ÙØ±Ù’Ø¯ÙØ©', full_word: 'ÙˆÙØ±Ù’Ø¯ÙØ©', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'ğŸŒ¹', distractors: ['Ø±', 'Ø²', 'Ø¯'] },
            { word_id: 165, correct_letter: 'ÙŠ', blank_word: '_ÙØ¯', full_word: 'ÙŠÙØ¯', position: 'Ø£ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©', image_emoji: 'âœ‹', distractors: ['Ø¨', 'Øª', 'Ù†'] },
        ];

        // --- Game Data: Mode 3 (Harakat) ---
        const wordListHarakat = [
            // Alif
            { word_id: 201, correct_letter: 'Ø£', correct_haraka: 'fatha', blank_word: '_Ø³ÙØ¯', full_word: 'Ø£ÙØ³ÙØ¯', image_emoji: 'ğŸ¦', correct_option: 'Ø£Ù' },
            { word_id: 202, correct_letter: 'Ø£', correct_haraka: 'damma', blank_word: '_Ø°ÙÙ†', full_word: 'Ø£ÙØ°ÙÙ†', image_emoji: 'ğŸ‘‚', correct_option: 'Ø£Ù' },
            { word_id: 203, correct_letter: 'Ø£', correct_haraka: 'kasra', blank_word: '_ÙØ¨Ù’Ø±ÙÙŠÙ‚', full_word: 'Ø¥ÙØ¨Ù’Ø±ÙÙŠÙ‚', image_emoji: 'ğŸ«–', correct_option: 'Ø¥Ù' },

            // Baa
            { word_id: 204, correct_letter: 'Ø¨', correct_haraka: 'fatha', blank_word: '_Ø·ÙØ©', full_word: 'Ø¨ÙØ·ÙØ©', image_emoji: 'ğŸ¦†', correct_option: 'Ø¨ÙÙ€' },
            { word_id: 205, correct_letter: 'Ø¨', correct_haraka: 'damma', blank_word: '_Ø±Ù’ØªÙÙ‚ÙØ§Ù„', full_word: 'Ø¨ÙØ±Ù’ØªÙÙ‚ÙØ§Ù„', image_emoji: 'ğŸŠ', correct_option: 'Ø¨ÙÙ€' },
            { word_id: 206, correct_letter: 'Ø¨', correct_haraka: 'kasra', blank_word: '_Ù†Ù’Øª', full_word: 'Ø¨ÙÙ†Ù’Øª', image_emoji: 'ğŸ‘§', correct_option: 'Ø¨ÙÙ€' },

            // Taa
            { word_id: 207, correct_letter: 'Øª', correct_haraka: 'fatha', blank_word: '_Ù…Ù’Ø±', full_word: 'ØªÙÙ…Ù’Ø±', image_emoji: 'ğŸŒ´', correct_option: 'ØªÙÙ€' },
            { word_id: 208, correct_letter: 'Øª', correct_haraka: 'damma', blank_word: '_ÙÙØ§Ø­', full_word: 'ØªÙÙÙØ§Ø­', image_emoji: 'ğŸ', correct_option: 'ØªÙÙ€' },
            { word_id: 209, correct_letter: 'Øª', correct_haraka: 'kasra', blank_word: '_Ù…Ù’Ø³ÙØ§Ø­', full_word: 'ØªÙÙ…Ù’Ø³ÙØ§Ø­', image_emoji: 'ğŸŠ', correct_option: 'ØªÙÙ€' },

            // Thaa
            { word_id: 210, correct_letter: 'Ø«', correct_haraka: 'fatha', blank_word: '_Ø¹Ù’Ù„ÙØ¨', full_word: 'Ø«ÙØ¹Ù’Ù„ÙØ¨', image_emoji: 'ğŸ¦Š', correct_option: 'Ø«ÙÙ€' },
            { word_id: 211, correct_letter: 'Ø«', correct_haraka: 'damma', blank_word: '_Ø¹Ù’Ø¨ÙØ§Ù†', full_word: 'Ø«ÙØ¹Ù’Ø¨ÙØ§Ù†', image_emoji: 'ğŸ', correct_option: 'Ø«ÙÙ€' },
            { word_id: 212, correct_letter: 'Ø«', correct_haraka: 'kasra', blank_word: '_ÙŠÙØ§Ø¨', full_word: 'Ø«ÙÙŠÙØ§Ø¨', image_emoji: 'ğŸ‘•', correct_option: 'Ø«ÙÙ€' },

            // Jeem
            { word_id: 213, correct_letter: 'Ø¬', correct_haraka: 'fatha', blank_word: '_Ø²ÙØ±', full_word: 'Ø¬ÙØ²ÙØ±', image_emoji: 'ğŸ¥•', correct_option: 'Ø¬ÙÙ€' },
            { word_id: 214, correct_letter: 'Ø¬', correct_haraka: 'damma', blank_word: '_Ø¨Ù’Ù†', full_word: 'Ø¬ÙØ¨Ù’Ù†', image_emoji: 'ğŸ§€', correct_option: 'Ø¬ÙÙ€' },
            { word_id: 215, correct_letter: 'Ø¬', correct_haraka: 'kasra', blank_word: '_Ø³Ù’Ø±', full_word: 'Ø¬ÙØ³Ù’Ø±', image_emoji: 'ğŸŒ‰', correct_option: 'Ø¬ÙÙ€' },

            // Haa
            { word_id: 216, correct_letter: 'Ø­', correct_haraka: 'fatha', blank_word: '_Ù„ÙÙŠØ¨', full_word: 'Ø­ÙÙ„ÙÙŠØ¨', image_emoji: 'ğŸ¥›', correct_option: 'Ø­ÙÙ€' },
            { word_id: 217, correct_letter: 'Ø­', correct_haraka: 'damma', blank_word: '_ÙˆØª', full_word: 'Ø­ÙÙˆØª', image_emoji: 'ğŸ‹', correct_option: 'Ø­ÙÙ€' },
            { word_id: 218, correct_letter: 'Ø­', correct_haraka: 'kasra', blank_word: '_ØµÙØ§Ù†', full_word: 'Ø­ÙØµÙØ§Ù†', image_emoji: 'ğŸ', correct_option: 'Ø­ÙÙ€' },

            // Khaa
            { word_id: 219, correct_letter: 'Ø®', correct_haraka: 'fatha', blank_word: '_Ø§ØªÙÙ…', full_word: 'Ø®ÙØ§ØªÙÙ…', image_emoji: 'ğŸ’', correct_option: 'Ø®ÙÙ€' },
            { word_id: 220, correct_letter: 'Ø®', correct_haraka: 'damma', blank_word: '_Ø¨Ù’Ø²', full_word: 'Ø®ÙØ¨Ù’Ø²', image_emoji: 'ğŸ', correct_option: 'Ø®ÙÙ€' },
            { word_id: 221, correct_letter: 'Ø®', correct_haraka: 'kasra', blank_word: '_ÙŠÙØ§Ø±', full_word: 'Ø®ÙÙŠÙØ§Ø±', image_emoji: 'ğŸ¥’', correct_option: 'Ø®ÙÙ€' },

            // Dal (Ø¯)
            { word_id: 222, correct_letter: 'Ø¯', correct_haraka: 'fatha', blank_word: '_ÙÙ’ØªÙØ±', full_word: 'Ø¯ÙÙÙ’ØªÙØ±', image_emoji: 'ğŸ“’', correct_option: 'Ø¯Ù' },
            { word_id: 223, correct_letter: 'Ø¯', correct_haraka: 'damma', blank_word: '_ÙˆØ¯ÙØ©', full_word: 'Ø¯ÙÙˆØ¯ÙØ©', image_emoji: 'ğŸª±', correct_option: 'Ø¯Ù' },
            { word_id: 224, correct_letter: 'Ø¯', correct_haraka: 'kasra', blank_word: '_ÙŠÙƒ', full_word: 'Ø¯ÙÙŠÙƒ', image_emoji: 'ğŸ“', correct_option: 'Ø¯Ù' },

            // Dhal (Ø°)
            { word_id: 225, correct_letter: 'Ø°', correct_haraka: 'fatha', blank_word: '_ÙÙŠÙ’Ù„', full_word: 'Ø°ÙÙŠÙ’Ù„', image_emoji: 'ğŸ•', image_url: 'https://png.pngtree.com/png-vector/20220216/ourmid/pngtree-cat-tail-vector-element-concept-design-template-pet-kitten-cats-tail-vector-png-image_44305428.jpg', correct_option: 'Ø°Ù' },
            { word_id: 226, correct_letter: 'Ø°', correct_haraka: 'damma', blank_word: '_Ø¨ÙØ§Ø¨ÙØ©', full_word: 'Ø°ÙØ¨ÙØ§Ø¨ÙØ©', image_emoji: 'ğŸª°', correct_option: 'Ø°Ù' },
            { word_id: 227, correct_letter: 'Ø°', correct_haraka: 'kasra', blank_word: '_Ø±ÙØ§Ø¹', full_word: 'Ø°ÙØ±ÙØ§Ø¹', image_emoji: 'ğŸ’ª', correct_option: 'Ø°Ù' },

            // Ra (Ø±)
            { word_id: 228, correct_letter: 'Ø±', correct_haraka: 'fatha', blank_word: '_Ù…Ù’Ù„', full_word: 'Ø±ÙÙ…Ù’Ù„', image_emoji: 'ğŸ–ï¸', correct_option: 'Ø±Ù' },
            { word_id: 229, correct_letter: 'Ø±', correct_haraka: 'damma', blank_word: '_ÙƒÙ’Ø¨ÙØ©', full_word: 'Ø±ÙÙƒÙ’Ø¨ÙØ©', image_emoji: 'ğŸ¦µ', correct_option: 'Ø±Ù' },
            { word_id: 230, correct_letter: 'Ø±', correct_haraka: 'kasra', blank_word: '_Ø³ÙØ§Ù„ÙØ©', full_word: 'Ø±ÙØ³ÙØ§Ù„ÙØ©', image_emoji: 'ğŸ“©', correct_option: 'Ø±Ù' },

            // Zay (Ø²)
            { word_id: 231, correct_letter: 'Ø²', correct_haraka: 'fatha', blank_word: '_Ø±ÙØ§ÙÙØ©', full_word: 'Ø²ÙØ±ÙØ§ÙÙØ©', image_emoji: 'ğŸ¦’', correct_option: 'Ø²Ù' },
            { word_id: 232, correct_letter: 'Ø²', correct_haraka: 'damma', blank_word: '_Ù‡ÙÙˆØ±', full_word: 'Ø²ÙÙ‡ÙÙˆØ±', image_emoji: 'ğŸ’', correct_option: 'Ø²Ù' },
            { word_id: 233, correct_letter: 'Ø²', correct_haraka: 'kasra', blank_word: '_Ø±', full_word: 'Ø²ÙØ±', image_emoji: 'ğŸ”´', image_url: 'https://img.freepik.com/free-vector/orange-button-isolated_1308-28825.jpg?semt=ais_hybrid&w=740&q=80', correct_option: 'Ø²Ù' },

            // Ain (Ø¹)
            { word_id: 234, correct_letter: 'Ø¹', correct_haraka: 'fatha', blank_word: '_Ù„ÙÙ…', full_word: 'Ø¹ÙÙ„ÙÙ…', image_emoji: 'ğŸ', correct_option: 'Ø¹ÙÙ€' },
            { word_id: 235, correct_letter: 'Ø¹', correct_haraka: 'damma', blank_word: '_ØµÙ’ÙÙÙˆØ±', full_word: 'Ø¹ÙØµÙ’ÙÙÙˆØ±', image_emoji: 'ğŸ¦', correct_option: 'Ø¹ÙÙ€' },
            { word_id: 236, correct_letter: 'Ø¹', correct_haraka: 'kasra', blank_word: '_Ù†ÙØ¨', full_word: 'Ø¹ÙÙ†ÙØ¨', image_emoji: 'ğŸ‡', correct_option: 'Ø¹ÙÙ€' },

            // Ghain (Øº)
            { word_id: 237, correct_letter: 'Øº', correct_haraka: 'fatha', blank_word: '_Ø²ÙØ§Ù„', full_word: 'ØºÙØ²ÙØ§Ù„', image_emoji: 'ğŸ¦Œ', correct_option: 'ØºÙÙ€' },
            { word_id: 238, correct_letter: 'Øº', correct_haraka: 'damma', blank_word: '_Ø±ÙØ§Ø¨', full_word: 'ØºÙØ±ÙØ§Ø¨', image_emoji: 'ğŸ¦â€â¬›', correct_option: 'ØºÙÙ€' },
            { word_id: 239, correct_letter: 'Øº', correct_haraka: 'kasra', blank_word: '_Ø°ÙØ§Ø¡', full_word: 'ØºÙØ°ÙØ§Ø¡', image_emoji: 'ğŸ±', correct_option: 'ØºÙÙ€' },

            // --- NEW HARAKAT LETTERS (Seen to Ya) ---
            // Seen (Ø³)
            { word_id: 240, correct_letter: 'Ø³', correct_haraka: 'fatha', blank_word: '_Ù…ÙÙƒÙØ©', full_word: 'Ø³ÙÙ…ÙÙƒÙØ©', image_emoji: 'ğŸŸ', correct_option: 'Ø³ÙÙ€' },
            { word_id: 241, correct_letter: 'Ø³', correct_haraka: 'damma', blank_word: '_Ù„Ù’Ø­ÙÙÙØ§Ø©', full_word: 'Ø³ÙÙ„Ù’Ø­ÙÙÙØ§Ø©', image_emoji: 'ğŸ¢', correct_option: 'Ø³ÙÙ€' },
            { word_id: 242, correct_letter: 'Ø³', correct_haraka: 'kasra', blank_word: '_Ù†Ù’Ø¬ÙØ§Ø¨', full_word: 'Ø³ÙÙ†Ù’Ø¬ÙØ§Ø¨', image_emoji: 'ğŸ¿ï¸', correct_option: 'Ø³ÙÙ€' },

            // Sheen (Ø´)
            { word_id: 243, correct_letter: 'Ø´', correct_haraka: 'fatha', blank_word: '_Ù…Ù’Ø¹ÙØ©', full_word: 'Ø´ÙÙ…Ù’Ø¹ÙØ©', image_emoji: 'ğŸ•¯ï¸', correct_option: 'Ø´ÙÙ€' },
            { word_id: 244, correct_letter: 'Ø´', correct_haraka: 'damma', blank_word: '_Ø±Ù’Ø·ÙÙŠ', full_word: 'Ø´ÙØ±Ù’Ø·ÙÙŠ', image_emoji: 'ğŸ‘®', correct_option: 'Ø´ÙÙ€' },
            { word_id: 245, correct_letter: 'Ø´', correct_haraka: 'kasra', blank_word: '_Ø±ÙØ§Ø¹', full_word: 'Ø´ÙØ±ÙØ§Ø¹', image_emoji: 'â›µ', correct_option: 'Ø´ÙÙ€' },

            // Sad (Øµ)
            { word_id: 246, correct_letter: 'Øµ', correct_haraka: 'fatha', blank_word: '_Ù‚Ù’Ø±', full_word: 'ØµÙÙ‚Ù’Ø±', image_emoji: 'ğŸ¦…', correct_option: 'ØµÙÙ€' },
            { word_id: 247, correct_letter: 'Øµ', correct_haraka: 'damma', blank_word: '_Ù†Ù’Ø¯ÙÙˆÙ‚', full_word: 'ØµÙÙ†Ù’Ø¯ÙÙˆÙ‚', image_emoji: 'ğŸ“¦', correct_option: 'ØµÙÙ€' },
            { word_id: 248, correct_letter: 'Øµ', correct_haraka: 'kasra', blank_word: '_ÙŠÙ†ÙÙŠÙØ©', full_word: 'ØµÙÙŠÙ†ÙÙŠÙØ©', image_emoji: 'ğŸ½ï¸', correct_option: 'ØµÙÙ€' },

            // Dhad (Ø¶)
            { word_id: 249, correct_letter: 'Ø¶', correct_haraka: 'fatha', blank_word: '_Ø§Ø¨ÙØ·', full_word: 'Ø¶ÙØ§Ø¨ÙØ·', image_emoji: 'ğŸ‘®', correct_option: 'Ø¶ÙÙ€' },
            { word_id: 250, correct_letter: 'Ø¶', correct_haraka: 'damma', blank_word: '_ÙÙ’Ø¯ÙØ¹', full_word: 'Ø¶ÙÙÙ’Ø¯ÙØ¹', image_emoji: 'ğŸ¸', correct_option: 'Ø¶ÙÙ€' },
            { word_id: 251, correct_letter: 'Ø¶', correct_haraka: 'kasra', blank_word: '_Ø±Ù’Ø³', full_word: 'Ø¶ÙØ±Ù’Ø³', image_emoji: 'ğŸ¦·', correct_option: 'Ø¶ÙÙ€' },

            // Ta (Ø·)
            { word_id: 252, correct_letter: 'Ø·', correct_haraka: 'fatha', blank_word: '_Ø§Ø¦ÙØ±ÙØ©', full_word: 'Ø·ÙØ§Ø¦ÙØ±ÙØ©', image_emoji: 'âœˆï¸', correct_option: 'Ø·ÙÙ€' },
            { word_id: 253, correct_letter: 'Ø·', correct_haraka: 'damma', blank_word: '_ÙŠÙÙˆØ±', full_word: 'Ø·ÙÙŠÙÙˆØ±', image_url: 'https://img.freepik.com/premium-vector/adorable-cartoon-bird-white-background-vector-illustration_1138841-51238.jpg', correct_option: 'Ø·ÙÙ€' },
            { word_id: 254, correct_letter: 'Ø·', correct_haraka: 'kasra', blank_word: '_ÙÙ’Ù„', full_word: 'Ø·ÙÙÙ’Ù„', image_emoji: 'ğŸ‘¶', correct_option: 'Ø·ÙÙ€' },

            // Zha (Ø¸)
            { word_id: 255, correct_letter: 'Ø¸', correct_haraka: 'fatha', blank_word: '_Ø±Ù’Ù', full_word: 'Ø¸ÙØ±Ù’Ù', image_emoji: 'âœ‰ï¸', correct_option: 'Ø¸ÙÙ€' },
            { word_id: 256, correct_letter: 'Ø¸', correct_haraka: 'damma', blank_word: '_ÙÙ’Ø±', full_word: 'Ø¸ÙÙÙ’Ø±', image_emoji: 'ğŸ’…', correct_option: 'Ø¸ÙÙ€' },
            { word_id: 257, correct_letter: 'Ø¸', correct_haraka: 'kasra', blank_word: '_Ù„', full_word: 'Ø¸ÙÙ„', image_url: 'https://img.freepik.com/free-vector/happy-boy-ready-play-with-his-silhouette_1308-50494.jpg', correct_option: 'Ø¸ÙÙ€' },

            // Fa (Ù)
            { word_id: 258, correct_letter: 'Ù', correct_haraka: 'fatha', blank_word: '_Ø±ÙØ§Ø´ÙØ©', full_word: 'ÙÙØ±ÙØ§Ø´ÙØ©', image_emoji: 'ğŸ¦‹', correct_option: 'ÙÙÙ€' },
            { word_id: 259, correct_letter: 'Ù', correct_haraka: 'damma', blank_word: '_Ù„Ù’ÙÙÙ„', full_word: 'ÙÙÙ„Ù’ÙÙÙ„', image_emoji: 'ğŸ«‘', correct_option: 'ÙÙÙ€' },
            { word_id: 260, correct_letter: 'Ù', correct_haraka: 'kasra', blank_word: '_ÙŠÙ„', full_word: 'ÙÙÙŠÙ„', image_emoji: 'ğŸ˜', correct_option: 'ÙÙÙ€' },

            // Qaf (Ù‚)
            { word_id: 261, correct_letter: 'Ù‚', correct_haraka: 'fatha', blank_word: '_Ù„ÙÙ…', full_word: 'qÙÙ„ÙÙ…', image_emoji: 'ğŸ–Šï¸', correct_option: 'Ù‚ÙÙ€' },
            { word_id: 262, correct_letter: 'Ù‚', correct_haraka: 'damma', blank_word: '_Ù†Ù’ÙÙØ°', full_word: 'Ù‚ÙÙ†Ù’ÙÙØ°', image_emoji: 'ğŸ¦”', correct_option: 'Ù‚ÙÙ€' },
            { word_id: 263, correct_letter: 'Ù‚', correct_haraka: 'kasra', blank_word: '_Ø·ÙØ©', full_word: 'Ù‚ÙØ·ÙØ©', image_emoji: 'ğŸˆ', correct_option: 'Ù‚ÙÙ€' },

            // Kaf (Ùƒ)
            { word_id: 264, correct_letter: 'Ùƒ', correct_haraka: 'fatha', blank_word: '_Ù„Ù’Ø¨', full_word: 'ÙƒÙÙ„Ù’Ø¨', image_emoji: 'ğŸ•', correct_option: 'ÙƒÙÙ€' },
            { word_id: 265, correct_letter: 'Ùƒ', correct_haraka: 'damma', blank_word: '_Ø±ÙØ©', full_word: 'ÙƒÙØ±ÙØ©', image_emoji: 'âš½', correct_option: 'ÙƒÙÙ€' },
            { word_id: 266, correct_letter: 'Ùƒ', correct_haraka: 'kasra', blank_word: '_ØªÙØ§Ø¨', full_word: 'ÙƒÙØªÙØ§Ø¨', image_emoji: 'ğŸ“–', correct_option: 'ÙƒÙÙ€' },

            // Lam (Ù„)
            { word_id: 267, correct_letter: 'Ù„', correct_haraka: 'fatha', blank_word: '_ÙŠÙ’Ù…ÙÙˆÙ†', full_word: 'Ù„ÙÙŠÙ’Ù…ÙÙˆÙ†', image_emoji: 'ğŸ‹', correct_option: 'Ù„ÙÙ€' },
            { word_id: 268, correct_letter: 'Ù„', correct_haraka: 'damma', blank_word: '_Ø¤Ù’Ù„ÙØ¤', full_word: 'Ù„ÙØ¤Ù’Ù„ÙØ¤', image_url: 'https://img.freepik.com/premium-photo/white-pearl-golden-seashell-clipart-illustration-white-background_1128301-3466.jpg', correct_option: 'Ù„ÙÙ€' },
            { word_id: 269, correct_letter: 'Ù„', correct_haraka: 'kasra', blank_word: '_Ø³ÙØ§Ù†', full_word: 'Ù„ÙØ³ÙØ§Ù†', image_emoji: 'ğŸ‘…', correct_option: 'Ù„ÙÙ€' },

            // Meem (Ù…)
            { word_id: 270, correct_letter: 'Ù…', correct_haraka: 'fatha', blank_word: '_ÙˆÙ’Ø²', full_word: 'Ù…ÙÙˆÙ’Ø²', image_emoji: 'ğŸŒ', correct_option: 'Ù…ÙÙ€' },
            { word_id: 271, correct_letter: 'Ù…', correct_haraka: 'damma', blank_word: '_Ù‡ÙØ±Ù‘ÙØ¬', full_word: 'Ù…ÙÙ‡ÙØ±Ù‘ÙØ¬', image_emoji: 'ğŸ¤¡', correct_option: 'Ù…ÙÙ€' },
            { word_id: 272, correct_letter: 'Ù…', correct_haraka: 'kasra', blank_word: '_Ù‚ÙØµ', full_word: 'Ù…ÙÙ‚ÙØµ', image_emoji: 'âœ‚ï¸', correct_option: 'Ù…ÙÙ€' },

            // Noon (Ù†)
            { word_id: 273, correct_letter: 'Ù†', correct_haraka: 'fatha', blank_word: '_Ø®Ù’Ù„ÙØ©', full_word: 'Ù†ÙØ®Ù’Ù„ÙØ©', image_emoji: 'ğŸŒ´', correct_option: 'Ù†ÙÙ€' },
            { word_id: 274, correct_letter: 'Ù†', correct_haraka: 'damma', blank_word: '_Ø¬ÙÙˆÙ…', full_word: 'Ù†ÙØ¬ÙÙˆÙ…', image_emoji: 'âœ¨', correct_option: 'Ù†ÙÙ€' },
            { word_id: 275, correct_letter: 'Ù†', correct_haraka: 'kasra', blank_word: '_Ø³Ù’Ø±', full_word: 'Ù†ÙØ³Ù’Ø±', image_emoji: 'ğŸ¦…', correct_option: 'Ù†ÙÙ€' },

            // Ha (Ù‡Ù€)
            { word_id: 276, correct_letter: 'Ù‡Ù€', correct_haraka: 'fatha', blank_word: '_Ø¯ÙÙŠÙØ©', full_word: 'Ù‡ÙØ¯ÙÙŠÙØ©', image_emoji: 'ğŸ', correct_option: 'Ù‡ÙÙ€' },
            { word_id: 277, correct_letter: 'Ù‡Ù€', correct_haraka: 'damma', blank_word: '_Ø¯Ù’Ù‡ÙØ¯', full_word: 'Ù‡ÙØ¯Ù’Ù‡ÙØ¯', image_url: 'https://media.istockphoto.com/id/1198596519/vector/vector-cute-african-animal-hoopoe-funny-character-for-kids.jpg', correct_option: 'Ù‡ÙÙ€' },
            { word_id: 278, correct_letter: 'Ù‡Ù€', correct_haraka: 'kasra', blank_word: '_Ù„ÙØ§Ù„', full_word: 'Ù‡ÙÙ„ÙØ§Ù„', image_emoji: 'ğŸŒ™', correct_option: 'Ù‡ÙÙ€' },

            // Waw (Ùˆ)
            { word_id: 279, correct_letter: 'Ùˆ', correct_haraka: 'fatha', blank_word: '_Ø±Ù’Ø¯ÙØ©', full_word: 'ÙˆÙØ±Ù’Ø¯ÙØ©', image_emoji: 'ğŸŒ¹', correct_option: 'ÙˆÙ' },
            { word_id: 280, correct_letter: 'Ùˆ', correct_haraka: 'damma', blank_word: '_Ø±ÙÙˆØ¯', full_word: 'ÙˆÙØ±ÙÙˆØ¯', image_url: 'https://www.shutterstock.com/image-vector/beautiful-flowers-artwork-simple-red-600nw-2602438365.jpg', correct_option: 'ÙˆÙ' },
            { word_id: 281, correct_letter: 'Ùˆ', correct_haraka: 'kasra', blank_word: '_Ø³ÙØ§Ø¯ÙØ©', full_word: 'ÙˆÙØ³ÙØ§Ø¯ÙØ©', image_url: 'https://img.freepik.com/premium-vector/pillow-clipart-vector-art-illustration_761413-27778.jpg', correct_option: 'ÙˆÙ' },

            // Ya (ÙŠ)
            { word_id: 282, correct_letter: 'ÙŠ', correct_haraka: 'fatha', blank_word: '_Ø¯', full_word: 'ÙŠÙØ¯', image_emoji: 'âœ‹', correct_option: 'ÙŠÙÙ€' },
            { word_id: 283, correct_letter: 'ÙŠ', correct_haraka: 'damma', blank_word: '_Ø³ÙØ§ÙÙØ±', full_word: 'ÙŠÙØ³ÙØ§ÙÙØ±', image_url: 'https://png.pngtree.com/png-vector/20250506/ourmid/pngtree-cartoon-travel-kid-sticker-png-image_16177982.png', correct_option: 'ÙŠÙÙ€' },
            // Skipped Kasra for Initial Ya as requested
        ];

        // --- UI Elements ---
        const welcomeScreen = document.getElementById('welcome-screen');
        const selectionScreen = document.getElementById('selection-screen');
        const gameScreen = document.getElementById('game-screen');

        const wordPlaceholder = document.getElementById('word-placeholder');
        const optionsGrid = document.getElementById('options-grid');
        const scoreDisplay = document.getElementById('score-display');
        const confettiHolder = document.getElementById('confetti-holder');
        const positionHint = document.getElementById('position-hint');
        const wordVisual = document.getElementById('word-visual');

        // --- Selection Screen Logic ---

        function showSelectionScreen(mode) {
            currentMode = mode;
            selectedLetters = []; // Reset selection

            welcomeScreen.classList.add('hidden');
            selectionScreen.classList.remove('hidden');

            renderSelectionGrid();
            updateStartButton();
        }

        function renderSelectionGrid() {
            const grid = document.getElementById('alphabet-grid');
            grid.innerHTML = '';

            arabicAlphabet.forEach(letter => {
                const isSupported = supportedLetters.includes(letter);
                const btn = document.createElement('button');
                btn.textContent = letter;
                btn.className = 'letter-grid-item font-bold text-xl shadow-sm transition-transform transform active:scale-95';

                if (!isSupported) {
                    // Disabled style
                    btn.classList.add('bg-gray-200', 'text-gray-400', 'border-gray-300', 'cursor-not-allowed');
                    btn.disabled = true;
                } else {
                    // Active/Selectable style
                    btn.onclick = () => toggleLetterSelection(letter, btn);
                    updateLetterButtonStyle(btn, false); // Initial state
                }

                grid.appendChild(btn);
            });
        }

        function toggleLetterSelection(letter, btnElement) {
            const index = selectedLetters.indexOf(letter);

            if (index > -1) {
                // Deselect
                selectedLetters.splice(index, 1);
                updateLetterButtonStyle(btnElement, false);
            } else {
                // Select (Always allowed)
                selectedLetters.push(letter);
                updateLetterButtonStyle(btnElement, true);
            }
            updateStartButton();
        }

        function updateLetterButtonStyle(btn, isSelected) {
            // Base interactive classes
            btn.className = 'letter-grid-item font-bold text-2xl shadow-sm transition-transform transform active:scale-95 border-2';

            if (isSelected) {
                btn.classList.add('bg-indigo-600', 'text-white', 'border-indigo-800', 'scale-105');
            } else {
                btn.classList.add('bg-white', 'text-indigo-800', 'border-indigo-200', 'hover:bg-indigo-50', 'hover:border-indigo-300');
            }
        }

        function updateStartButton() {
            const btn = document.getElementById('start-game-btn');
            const instruction = document.getElementById('selection-instruction');
            const count = selectedLetters.length;

            instruction.textContent = `ØªÙ… Ø§Ø®ØªÙŠØ§Ø±: ${count} (Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰: ${minSelectionCount})`;

            if (count >= minSelectionCount) {
                btn.disabled = false;
                instruction.classList.add('text-green-600', 'font-bold');
                instruction.classList.remove('text-gray-600');
            } else {
                btn.disabled = true;
                instruction.classList.remove('text-green-600', 'font-bold');
                instruction.classList.add('text-gray-600');
            }
        }

        // --- Game Start Logic ---

        async function confirmSelectionAndStart() {
            await Tone.start();

            // Clear previous timer to prevent conflicts
            if (gameTimer) clearTimeout(gameTimer);

            selectionScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');

            startGameLogic();
        }

        function goHome() {
            // Clear pending game timer to stop actions after leaving screen
            if (gameTimer) clearTimeout(gameTimer);

            // Reset UI state
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('selection-screen').classList.add('hidden');
            document.getElementById('welcome-screen').classList.remove('hidden');

            // Reset layout elements
            document.getElementById('question-card').classList.remove('hidden');
            document.getElementById('options-grid').classList.remove('hidden');
            document.getElementById('lives-display').classList.remove('hidden');

            const existingMsgs = document.getElementById('game-screen').querySelectorAll('.bg-green-100, .bg-red-100');
            existingMsgs.forEach(m => m.remove());

            document.getElementById('game-container').classList.remove('flex-col', 'justify-center');

            confettiHolder.classList.add('hidden');
            confettiHolder.innerHTML = '';
        }

        function startGameLogic() {
            // Reset score
            gameScore = 0;
            document.getElementById('score-display').textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${gameScore}`;

            // Reset layout just in case coming from game over
            document.getElementById('question-card').classList.remove('hidden');
            document.getElementById('options-grid').classList.remove('hidden');
            document.getElementById('lives-display').classList.remove('hidden');
            document.getElementById('game-container').classList.remove('flex-col', 'justify-center');

            const existingMsgs = document.getElementById('game-screen').querySelectorAll('.bg-green-100, .bg-red-100');
            existingMsgs.forEach(m => m.remove());

            gameLives = 3;
            updateHeartsDisplay();

            // 1. Select correct list based on mode
            let fullList = [];
            if (currentMode === 'shapes') {
                fullList = wordListShapes;
            } else if (currentMode === 'letters') {
                fullList = wordListLetters;
            } else if (currentMode === 'harakat') {
                fullList = wordListHarakat;
            }

            // 2. Filter list based on selection
            // Keep only words where the correct_letter is in the selectedLetters array
            let filteredList = fullList.filter(word => selectedLetters.includes(word.correct_letter));

            // 3. Clone and shuffle
            wordList = JSON.parse(JSON.stringify(filteredList));
            shuffleArray(wordList);

            // 4. Limit count (Win condition logic)
            // If we have fewer than 10 words, we use all of them. If more, we cap at 10.
            const maxQuestions = Math.min(10, wordList.length);
            if (wordList.length > maxQuestions) {
                wordList = wordList.slice(0, maxQuestions);
            }

            loadQuestion();
        }

        // --- Standard Game Functions ---

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function updateHeartsDisplay() {
            const livesDisplay = document.getElementById('lives-display');
            livesDisplay.textContent = 'â¤ï¸'.repeat(gameLives);
        }

        function gameComplete() {
            document.getElementById('question-card').classList.add('hidden');
            document.getElementById('options-grid').classList.add('hidden');
            document.getElementById('lives-display').classList.add('hidden');

            document.getElementById('game-container').classList.add('flex-col', 'justify-center');

            const completeMessage = document.createElement('div');
            completeMessage.className = "text-center p-8 bg-green-100 rounded-3xl shadow-xl border-4 border-green-500 max-w-lg w-full";
            completeMessage.innerHTML = `
            <div class="text-7xl mb-4">ğŸ‰</div>
            <h2 class="text-4xl font-extrabold text-green-600 mb-3">Ø£Ø­Ø³Ù†Øª!</h2>
            <p class="text-xl text-gray-700 mb-6">Ø£ÙƒÙ…Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!</p>
            <p class="text-2xl text-gray-800 mb-6 font-bold">Ù†Ù‚Ø§Ø·Ùƒ: ${gameScore}</p>
            <button onclick="goHome()" class="px-8 py-3 bg-blue-600 text-white text-2xl font-bold rounded-full shadow-lg hover:bg-blue-700 transition duration-300 w-full transform hover:scale-105">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        `;
            document.getElementById('game-screen').appendChild(completeMessage);
        }

        function gameOver() {
            document.getElementById('question-card').classList.add('hidden');
            document.getElementById('options-grid').classList.add('hidden');
            document.getElementById('lives-display').classList.add('hidden');

            document.getElementById('game-container').classList.add('flex-col', 'justify-center');

            const gameOverMessage = document.createElement('div');
            gameOverMessage.className = "text-center p-8 bg-red-100 rounded-3xl shadow-xl border-4 border-red-500 max-w-lg w-full";
            gameOverMessage.innerHTML = `
            <div class="text-7xl mb-4">ğŸ’”</div>
            <h2 class="text-4xl font-extrabold text-red-600 mb-3">Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©</h2>
            <p class="text-2xl text-gray-800 mb-6 font-bold">Ù†Ù‚Ø§Ø·Ùƒ: ${gameScore}</p>
            <button onclick="goHome()" class="px-8 py-3 bg-red-600 text-white text-2xl font-bold rounded-full shadow-lg hover:bg-red-700 transition duration-300 w-full transform hover:scale-105">Ø®Ø±ÙˆØ¬</button>
            <button onclick="startGameLogic()" class="mt-4 px-8 py-3 bg-green-600 text-white text-2xl font-bold rounded-full shadow-lg hover:bg-green-700 transition duration-300 w-full transform hover:scale-105">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>
        `;
            document.getElementById('game-screen').appendChild(gameOverMessage);
        }

        function getCorrectShape(word) {
            if (word.shape_key) return letterShapes[word.correct_letter][word.shape_key];

            let correctShapeKey;
            if (word.position.includes('Ø§Ù„Ù€Ø¨Ù€Ø¯Ø§ÙŠÙ€Ø©')) correctShapeKey = 'initial';
            else if (word.position.includes('Ø§Ù„Ù€ÙˆØ³Ù€Ø·')) correctShapeKey = 'medial';
            else correctShapeKey = 'final';

            return letterShapes[word.correct_letter][correctShapeKey];
        }

        function generateHarakatOptions(letter) {
            if (letter === 'Ø£') {
                return ['Ø£Ù', 'Ø£Ù', 'Ø¥Ù'];
            }

            const initialShape = letterShapes[letter]['initial'];

            // Correct logic for handling non-connectors
            if (initialShape.includes('Ù€')) {
                return [
                    initialShape.replace('Ù€', 'ÙÙ€'), // Fatha
                    initialShape.replace('Ù€', 'ÙÙ€'), // Damma
                    initialShape.replace('Ù€', 'ÙÙ€')  // Kasra
                ];
            } else {
                // Non-connectors (d, dh, r, z, etc.)
                return [
                    initialShape + 'Ù', // Fatha
                    initialShape + 'Ù', // Damma
                    initialShape + 'Ù'  // Kasra
                ];
            }
        }

        function loadQuestion() {
            if (wordList.length === 0) {
                gameComplete();
                return;
            }

            isProcessing = false;
            currentWord = wordList.pop();

            // 1. Display Visual
            wordVisual.innerHTML = ''; // Clear previous
            if (currentWord.image_url) {
                const img = document.createElement('img');
                img.src = currentWord.image_url;
                img.className = 'w-full h-full object-contain drop-shadow-md';
                img.alt = currentWord.full_word;
                // Added referrerpolicy and onerror for robustness
                img.setAttribute('referrerpolicy', 'no-referrer');
                img.setAttribute('onerror', 'this.onerror=null; this.src="https://placehold.co/128x128/9CA3AF/FFFFFF?text=Ø®Ø·Ø£+ØµÙˆØ±Ø©"');
                wordVisual.appendChild(img);
                wordVisual.classList.remove('text-6xl');
            } else {
                wordVisual.textContent = currentWord.image_emoji;
                wordVisual.classList.add('text-6xl');
            }

            // 2. Display the blank word (CLEANED of harakat)
            // We use the helper function to strip harakat from the blank word pattern
            let blankWordDisplay = currentWord.blank_word;

            const highlightedWord = blankWordDisplay.replace(
                '_',
                '<span class="highlight-blank">Ù€</span>'
            );

            wordPlaceholder.innerHTML = highlightedWord;

            // Hint text changes slightly based on mode
            if (currentMode === 'shapes') {
                positionHint.textContent = `(Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„ØµØ­ÙŠØ­ Ù„Ø­Ø±Ù ${currentWord.correct_letter})`;
            } else if (currentMode === 'harakat') {
                positionHint.textContent = `(Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù„Ø­Ø±Ù ${currentWord.correct_letter})`;
            } else {
                positionHint.textContent = `(Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø­Ø±Ù Ø§Ù„Ù†Ø§Ù‚ØµØŸ)`;
            }

            // 3. Generate options
            optionsGrid.innerHTML = '';
            let options = [];

            if (currentMode === 'shapes') {
                const allShapesRaw = Object.values(letterShapes[currentWord.correct_letter]);
                options = [...new Set(allShapesRaw)];
            } else if (currentMode === 'harakat') {
                // Generate the 3 harakat options for the correct letter
                options = generateHarakatOptions(currentWord.correct_letter);
            } else {
                // Letters mode
                // Safety check: ensure distractors exist
                const distractors = currentWord.distractors || [];
                options = [currentWord.correct_letter, ...distractors];
            }

            shuffleArray(options);

            options.forEach(val => {
                const button = document.createElement('button');
                button.textContent = val;
                button.className = 'option-button bg-yellow-500 text-white font-extrabold p-4 rounded-2xl shadow-xl hover:bg-yellow-600 active:scale-95 transition duration-150 transform flex items-center justify-center';
                button.onclick = () => checkAnswer(val, button);
                optionsGrid.appendChild(button);
            });
        }

        function checkAnswer(chosenValue, buttonElement) {
            if (isProcessing) return;

            let isCorrect = false;

            if (currentMode === 'shapes') {
                const correctShape = getCorrectShape(currentWord);
                isCorrect = (chosenValue === correctShape);
            } else if (currentMode === 'harakat') {
                // Compare with the pre-defined correct visual option
                isCorrect = (chosenValue === currentWord.correct_option);
            } else {
                isCorrect = (chosenValue === currentWord.correct_letter);
            }

            if (isCorrect) {
                isProcessing = true;
                gameScore++;
                scoreDisplay.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${gameScore}`;

                correctSound();
                wordPlaceholder.textContent = currentWord.full_word;
                showReward();

                document.querySelectorAll('.option-button').forEach(btn => btn.disabled = true);

                // Assign timeout to variable so it can be cleared
                gameTimer = setTimeout(() => {
                    loadQuestion();
                }, 2500);

            } else {
                incorrectSound();
                gameLives--;
                updateHeartsDisplay();

                if (gameLives <= 0) {
                    isProcessing = true;
                    gameOver();
                    return;
                }

                buttonElement.classList.add('bg-red-500', 'ring-4', 'ring-red-300');
                buttonElement.classList.remove('bg-yellow-500', 'hover:bg-yellow-600');

                setTimeout(() => {
                    buttonElement.classList.remove('bg-red-500', 'ring-4', 'ring-red-300');
                    buttonElement.classList.add('bg-yellow-500', 'hover:bg-yellow-600');
                }, 500);
            }
        }

        // --- Fun Reward Implementation ---

        function showReward() {
            startConfetti();
            // REMOVED: Bouncing Emoji horizontal animation logic as per request.
            // Only confetti remains.
        }

        function startConfetti() {
            confettiHolder.classList.remove('hidden');
            const colors = ['#f43f5e', '#facc15', '#4ade80', '#3b82f6', '#ec4899'];
            const count = 50;

            for (let i = 0; i < count; i++) {
                const c = document.createElement('div');
                c.className = 'confetti';
                c.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                c.style.left = `${Math.random() * 100}vw`;
                c.style.top = `${Math.random() * 10 - 20}vh`;
                c.style.animationDelay = `${Math.random() * 0.5}s`;
                c.style.animationDuration = `${1.5 + Math.random() * 1}s`;
                confettiHolder.appendChild(c);
            }

            setTimeout(() => {
                confettiHolder.innerHTML = '';
                confettiHolder.classList.add('hidden');
            }, 2500);
        }

    </script>
</body>

</html>
